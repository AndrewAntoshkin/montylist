# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: FFmpeg Copy –≤–º–µ—Å—Ç–æ Re-encode

## üîç –ü–†–û–ë–õ–ï–ú–ê:

### –ß—Ç–æ –±—ã–ª–æ:
```
–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –≤–∏–¥–µ–æ: 140 MB
‚Üì FFmpeg —Ä–∞–∑—Ä–µ–∑–∫–∞ —Å re-encode
Chunk 0: 442 MB ‚Üê ‚ùå –í 3 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ!
Chunk 1: 478 MB ‚Üê ‚ùå –í 3 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ!
```

### –ü–æ—á–µ–º—É —Ç–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ:

**FFmpeg –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
```typescript
'-c:v libx264',       // Re-encode video
'-preset ultrafast',  // –ù–∏–∑–∫–∞—è –∫–æ–º–ø—Ä–µ—Å—Å–∏—è
'-crf 23',            // –•–æ—Ä–æ—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ
'-c:a aac',           // Re-encode audio
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `ultrafast` preset = –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ, –Ω–æ **–Ω–∏–∑–∫–∞—è –∫–æ–º–ø—Ä–µ—Å—Å–∏—è**
- Re-encode –≤—Å–µ–≥–æ –≤–∏–¥–µ–æ –∑–∞–Ω–∏–º–∞–µ—Ç –≤—Ä–µ–º—è –∏ **—É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä**
- 140 MB ‚Üí 920 MB –ø–æ—Å–ª–µ —Ä–∞–∑—Ä–µ–∑–∫–∏!

---

## ‚úÖ –†–ï–®–ï–ù–ò–ï:

### –ò—Å–ø–æ–ª—å–∑—É–µ–º `-c:v copy -c:a copy`:

```typescript
'-c:v copy',  // Copy video stream (–±–µ–∑ re-encode!)
'-c:a copy',  // Copy audio stream (–±–µ–∑ re-encode!)
```

### –ß—Ç–æ —ç—Ç–æ –¥–∞–µ—Ç:

‚úÖ **–°–∫–æ—Ä–æ—Å—Ç—å:** –†–∞–∑—Ä–µ–∑–∫–∞ –∑–∞ —Å–µ–∫—É–Ω–¥—ã (–≤–º–µ—Å—Ç–æ –º–∏–Ω—É—Ç)
- –ë—ã–ª–æ: ~40 —Å–µ–∫—É–Ω–¥ –Ω–∞ —á–∞–Ω–∫
- –°—Ç–∞–ª–æ: ~2-3 —Å–µ–∫—É–Ω–¥—ã –Ω–∞ —á–∞–Ω–∫

‚úÖ **–†–∞–∑–º–µ—Ä:** –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä
- –ë—ã–ª–æ: 442 MB –Ω–∞ —á–∞–Ω–∫
- –°—Ç–∞–ª–æ: ~47 MB –Ω–∞ —á–∞–Ω–∫ (140 MB / 3 = ~47 MB)

‚úÖ **–ö–∞—á–µ—Å—Ç–≤–æ:** –ë–µ–∑ –ø–æ—Ç–µ—Ä—å (pixel-perfect copy)

‚úÖ **–ü–∞–º—è—Ç—å:** –ú–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

---

## üìä –†–ï–ó–£–õ–¨–¢–ê–¢:

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```
–û—Ä–∏–≥–∏–Ω–∞–ª: 140 MB (25 –º–∏–Ω—É—Ç)
‚îú‚îÄ Chunk 0 (10 –º–∏–Ω): 442 MB ‚Üê ‚ùå
‚îú‚îÄ Chunk 1 (10 –º–∏–Ω): 478 MB ‚Üê ‚ùå
‚îî‚îÄ Chunk 2 (5 –º–∏–Ω):  ~240 MB ‚Üê ‚ùå
Total: ~1160 MB (8x —É–≤–µ–ª–∏—á–µ–Ω–∏–µ!)
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```
–û—Ä–∏–≥–∏–Ω–∞–ª: 140 MB (25 –º–∏–Ω—É—Ç)
‚îú‚îÄ Chunk 0 (10 –º–∏–Ω): ~56 MB ‚Üê ‚úÖ
‚îú‚îÄ Chunk 1 (10 –º–∏–Ω): ~56 MB ‚Üê ‚úÖ
‚îî‚îÄ Chunk 2 (5 –º–∏–Ω):  ~28 MB ‚Üê ‚úÖ
Total: ~140 MB (–±–µ–∑ —É–≤–µ–ª–∏—á–µ–Ω–∏—è!)
```

---

## ‚ö†Ô∏è –í–ê–ñ–ù–û:

### –ö–æ–≥–¥–∞ `-c copy` —Ä–∞–±–æ—Ç–∞–µ—Ç:

‚úÖ –í–∏–¥–µ–æ —É–∂–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ MP4/H.264
‚úÖ –í–∏–¥–µ–æ —É–∂–µ –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π moov atom
‚úÖ –ù–µ –Ω—É–∂–Ω–æ –º–µ–Ω—è—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ/–±–∏—Ç—Ä–µ–π—Ç

### –ö–æ–≥–¥–∞ –Ω—É–∂–µ–Ω re-encode:

‚ùå –í–∏–¥–µ–æ –≤ –¥—Ä—É–≥–æ–º —Ñ–æ—Ä–º–∞—Ç–µ (MOV, AVI, MKV)
‚ùå –ù—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ
‚ùå –ù—É–∂–Ω–æ —Å–∂–∞—Ç—å –≤–∏–¥–µ–æ
‚ùå –ü—Ä–æ–±–ª–µ–º—ã —Å moov atom

**–í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ:** –í–∏–¥–µ–æ —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ —á–µ—Ä–µ–∑ TUS –≤ Supabase ‚Üí —Ñ–æ—Ä–º–∞—Ç –≤–∞–ª–∏–¥–Ω—ã–π ‚Üí copy –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å! ‚úÖ

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï:

### –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä –∏ –ø–æ–ø—Ä–æ–±—É–π —Å–Ω–æ–≤–∞:

1. **–û—Å—Ç–∞–Ω–æ–≤–∏ —Ç–µ–∫—É—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑—Ä–µ–∑–∫–∏** (–µ—Å–ª–∏ –∏–¥—ë—Ç)
2. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ dev server:**
   ```bash
   npm run dev
   ```
3. **–ó–∞–≥—Ä—É–∑–∏ —Ç–æ –∂–µ –≤–∏–¥–µ–æ —Å–Ω–æ–≤–∞**
4. **–°–º–æ—Ç—Ä–∏ –ª–æ–≥–∏:**

```
‚úÇÔ∏è  Cutting chunk 1: 0s - 600s (600s)
FFmpeg command: ffmpeg -ss 0 -i ... -c:v copy -c:a copy ...
‚úÖ Chunk 1 created: /tmp/video-chunks/chunk_0_xxx.mp4
üì¶ Uploading chunk 0 size: 56.25 MB ‚Üê ‚úÖ –ù–æ—Ä–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä!
‚úÖ Chunk 0 uploaded successfully
```

---

## üéâ –í–´–í–û–î–´:

**Re-encode –Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏:**
- –ú–µ–Ω—è–µ–º —Ñ–æ—Ä–º–∞—Ç
- –ú–µ–Ω—è–µ–º –∫–æ–¥–µ–∫
- –ú–µ–Ω—è–µ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ/–±–∏—Ç—Ä–µ–π—Ç
- –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –ø—Ä–æ–±–ª–µ–º—ã —Å —Ñ–æ—Ä–º–∞—Ç–æ–º

**Copy –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ–≥–¥–∞:**
- –ü—Ä–æ—Å—Ç–æ —Ä–∞–∑—Ä–µ–∑–∞–µ–º –≤–∏–¥–µ–æ
- –§–æ—Ä–º–∞—Ç —É–∂–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- –ù—É–∂–Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å
- –ù–µ —Ö–æ—Ç–∏–º —Ç–µ—Ä—è—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ

**–í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ:** Copy –∏–¥–µ–∞–ª–µ–Ω! ‚úÖ

---

**–ü–æ–ø—Ä–æ–±—É–π —Å–µ–π—á–∞—Å!** üöÄ



