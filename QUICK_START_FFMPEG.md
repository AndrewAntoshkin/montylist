# üöÄ FFmpeg Scene Detection - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

## ‚úÖ –ß—Ç–æ –≥–æ—Ç–æ–≤–æ

–í–Ω–µ–¥—Ä–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ —Ç–æ—á–Ω–æ–π –¥–µ—Ç–µ–∫—Ü–∏–∏ —Å–∫–ª–µ–µ–∫ —á–µ—Ä–µ–∑ FFmpeg!

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –¢–∞–π–º–∫–æ–¥—ã –≤—Å—Ç—ã–∫ (–±–µ–∑ —Ä–∞–∑—Ä—ã–≤–æ–≤)
- ‚úÖ –ù–∞—Ö–æ–¥–∏—Ç –í–°–ï —Å–∫–ª–µ–π–∫–∏ (–¥–∞–∂–µ <1 —Å–µ–∫)
- ‚úÖ –¢–æ—á–Ω–æ—Å—Ç—å 95%+ –≤–º–µ—Å—Ç–æ 70%
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ (–º–æ–∂–Ω–æ –æ—Ç–∫–∞—Ç–∏—Ç—å)

---

## üé¨ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å (3 –º–∏–Ω—É—Ç—ã)

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ FFmpeg

```bash
ffmpeg -version
```

–ï—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:
```bash
brew install ffmpeg  # macOS
```

### 2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ –≤–∏–¥–µ–æ

```bash
node scripts/test-scene-detection.js /–ø—É—Ç—å/–∫/–≤–∏–¥–µ–æ.mp4
```

**–•–æ—Ä–æ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ Detection completed in 35s
üìä Total scenes detected: 856
   Scenes per minute: 17.7
```

### 3. –í–∫–ª—é—á–∏—Ç–µ –≤ .env.local

–î–æ–±–∞–≤—å—Ç–µ/–∏–∑–º–µ–Ω–∏—Ç–µ:
```bash
USE_SCENE_DETECTION=true
SCENE_DETECTION_THRESHOLD=0.3
```

### 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä

```bash
# Ctrl+C –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
npm run dev
```

### 5. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ö–û–†–û–¢–ö–û–ï –≤–∏–¥–µ–æ (2-5 –º–∏–Ω)

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
```
üé¨ FFmpeg Scene Detection is ENABLED
‚úÖ Scene detection completed in 12s
üìä Total scenes found: 145
```

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

–ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

‚úì **–¢–∞–π–º–∫–æ–¥—ã –∏–¥—É—Ç –≤—Å—Ç—ã–∫:**
```
–ü–ª–∞–Ω 10: ... - 00:05:30:17
–ü–ª–∞–Ω 11: 00:05:30:17 - ...  ‚Üê —Å–æ–≤–ø–∞–¥–∞–µ—Ç!
```

‚úì **–ù–µ—Ç –ø—Ä–æ–ø—É—Å–∫–æ–≤ –≤ –Ω—É–º–µ—Ä–∞—Ü–∏–∏:** 1, 2, 3, 4...

‚úì **–ë–æ–ª—å—à–µ –ø–ª–∞–Ω–æ–≤:** ~18-22 –≤ –º–∏–Ω—É—Ç—É

‚úì **–î–∏–∞–ª–æ–≥–∏ –ø–æ–ª–Ω—ã–µ** (–Ω–µ –ø–æ—Ç–µ—Ä—è–Ω—ã —á–∞—Å—Ç–∏)

---

## üîÑ –û—Ç–∫–∞—Ç (–µ—Å–ª–∏ –Ω–µ –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å)

**–í–∞—Ä–∏–∞–Ω—Ç 1: –ü—Ä–æ—Å—Ç–æ –æ—Ç–∫–ª—é—á–∏—Ç—å**
```bash
# –í .env.local
USE_SCENE_DETECTION=false
```

**–í–∞—Ä–∏–∞–Ω—Ç 2: –ü–æ–ª–Ω—ã–π –æ—Ç–∫–∞—Ç**
```bash
cp backup/20251124_003142/*.backup app/api/*/route.ts
cp backup/20251124_003142/gemini-prompt.ts lib/
```

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø–ª–∞–Ω–æ–≤?**
```bash
SCENE_DETECTION_THRESHOLD=0.4  # –º–µ–Ω—å—à–µ –ø–ª–∞–Ω–æ–≤
```

**–°–ª–∏—à–∫–æ–º –º–∞–ª–æ –ø–ª–∞–Ω–æ–≤?**
```bash
SCENE_DETECTION_THRESHOLD=0.2  # –±–æ–ª—å—à–µ –ø–ª–∞–Ω–æ–≤
```

**–ó–æ–ª–æ—Ç–∞—è —Å–µ—Ä–µ–¥–∏–Ω–∞:** `0.3` (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ

### –î–û (Gemini-only):
- –ü–ª–∞–Ω–æ–≤: ~600 (48 –º–∏–Ω)
- –†–∞–∑—Ä—ã–≤—ã: —á–∞—Å—Ç—ã–µ
- –¢–æ—á–Ω–æ—Å—Ç—å: ~70%

### –ü–û–°–õ–ï (FFmpeg+Gemini):
- –ü–ª–∞–Ω–æ–≤: ~900-1100 (48 –º–∏–Ω)
- –†–∞–∑—Ä—ã–≤—ã: 0
- –¢–æ—á–Ω–æ—Å—Ç—å: ~95%

---

## üÜò –ü–æ–º–æ—â—å

**–ü—Ä–æ–±–ª–µ–º–∞:** FFmpeg –Ω–µ –Ω–∞–π–¥–µ–Ω
‚Üí –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ: `brew install ffmpeg`

**–ü—Ä–æ–±–ª–µ–º–∞:** –î–µ—Ç–µ–∫—Ü–∏—è –¥–æ–ª–≥–∞—è
‚Üí –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, ~30-60 —Å–µ–∫ –¥–ª—è 50-–º–∏–Ω –≤–∏–¥–µ–æ

**–ü—Ä–æ–±–ª–µ–º–∞:** –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ/–º–∞–ª–æ —Å—Ü–µ–Ω
‚Üí –ù–∞—Å—Ç—Ä–æ–π—Ç–µ threshold (0.2-0.5)

---

**–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üéâ

**–ù–∞—á–Ω–∏—Ç–µ —Å:** `node scripts/test-scene-detection.js video.mp4`












