# PySceneDetect V4 Setup

## –ß—Ç–æ —ç—Ç–æ?

**V4** ‚Äî –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∏–¥–µ–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **PySceneDetect** –≤–º–µ—Å—Ç–æ FFmpeg –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ —Å—Ü–µ–Ω.

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ PySceneDetect:
- üéØ **–¢–æ—á–Ω–µ–µ** ‚Äî AdaptiveDetector –ª—É—á—à–µ —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç –Ω–∞–ø–ª—ã–≤—ã –∏ –∑–∞—Ç—É—Ö–∞–Ω–∏—è
- üé¨ **–ú–µ–Ω—å—à–µ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π** ‚Äî –Ω–µ –ø—É—Ç–∞–µ—Ç –¥–≤–∏–∂–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã —Å–æ —Å–º–µ–Ω–æ–π —Å—Ü–µ–Ω—ã
- üìä **–õ—É—á—à–µ –¥–ª—è –∫–∏–Ω–æ** ‚Äî –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ñ–∏–ª—å–º–æ–≤

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PySceneDetect

### –í–∞—Ä–∏–∞–Ω—Ç 1: pip (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
pip install scenedetect[opencv]
```

–ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∞ SSL:
```bash
pip install --trusted-host pypi.org --trusted-host files.pythonhosted.org scenedetect[opencv]
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: conda

```bash
conda install -c conda-forge scenedetect
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: homebrew (macOS)

```bash
brew install opencv
pip install scenedetect
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```bash
scenedetect --version
```

–î–æ–ª–∂–µ–Ω –≤—ã–≤–µ—Å—Ç–∏:
```
PySceneDetect 0.6.x
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–Ω–æ–ø–∫–∞ **"V4 PyScene"** –≤ –¥–∞—à–±–æ—Ä–¥–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å.

### –ü–∞–π–ø–ª–∞–π–Ω V4:

1. **–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ü–µ–Ω–∞—Ä–∏—è** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) ‚Üí –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π
2. **–ó–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ** ‚Üí TUS upload
3. **PySceneDetect** ‚Üí —Ç–æ—á–Ω—ã–µ —Ç–∞–π–º–∫–æ–¥—ã —Å—Ü–µ–Ω
4. **Gemini AI** ‚Üí –æ–ø–∏—Å–∞–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è
5. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ** ‚Üí –º–æ–Ω—Ç–∞–∂–Ω—ã–π –ª–∏—Å—Ç –≥–æ—Ç–æ–≤

## –§–∞–π–ª—ã V4

```
lib/pyscenedetect.ts          # –û–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ PySceneDetect CLI
lib/prompts-v4.ts              # –ü—Ä–æ–º–ø—Ç—ã –¥–ª—è Gemini
app/api/init-processing-v4/    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å PySceneDetect
app/api/process-chunk-v4/      # –û–±—Ä–∞–±–æ—Ç–∫–∞ —á–∞–Ω–∫–æ–≤
app/api/process-all-chunks-v4/ # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä
components/UploadModalV4.tsx   # UI –º–æ–¥–∞–ª
```

## Fallback –Ω–∞ FFmpeg

–ï—Å–ª–∏ PySceneDetect –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, V4 –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—Å—è –Ω–∞ FFmpeg:

```typescript
// lib/pyscenedetect.ts
if (!isPySceneDetectAvailable) {
  console.warn('‚ö†Ô∏è PySceneDetect not available, falling back to FFmpeg');
  // ... uses FFmpeg instead
}
```

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ V3 vs V4

| –ê—Å–ø–µ–∫—Ç | V3 (FFmpeg) | V4 (PySceneDetect) |
|--------|-------------|-------------------|
| –°–∫–æ—Ä–æ—Å—Ç—å | –ë—ã—Å—Ç—Ä–µ–µ | –ù–µ–º–Ω–æ–≥–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ |
| –¢–æ—á–Ω–æ—Å—Ç—å | –•–æ—Ä–æ—à–∞—è | –û—Ç–ª–∏—á–Ω–∞—è |
| –ù–∞–ø–ª—ã–≤—ã | –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç | –†–∞—Å–ø–æ–∑–Ω–∞—ë—Ç |
| –ù–∞—Å—Ç—Ä–æ–π–∫–∞ | threshold | AdaptiveDetector |

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### "scenedetect: command not found"

PySceneDetect –Ω–µ –≤ PATH. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:
```bash
pip install scenedetect[opencv]
```

### "No module named cv2"

OpenCV –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:
```bash
pip install opencv-python
```

### –ú–µ–¥–ª–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

PySceneDetect –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫–∞–∂–¥—ã–π –∫–∞–¥—Ä. –î–ª—è –¥–ª–∏–Ω–Ω—ã—Ö –≤–∏–¥–µ–æ —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ. 
–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å V3 (FFmpeg) –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏.

